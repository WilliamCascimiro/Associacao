@using Associacao.App.Extensions
@model Associacao.App.Models.PessoaViewModel
@*@model Associacao.App.Models.PessoaMensalidadeViewModel*@

@{
    ViewData["Title"] = "Details";
}

<h1>@Html.DisplayFor(model => model.Nome) - @Model.NumeroCadastro</h1>

<div class="container">
    <div class="col-6 col-md-6 div-month">
        <div class="row">
            <div class="col">
                Jan
            </div>
            <div class="col">
                Fev
            </div>
            <div class="col">
                Mar
            </div>
            <div class="col">
                Abr
            </div>
            <div class="col">
                Mai
            </div>
            <div class="col">
                Jun
            </div>
            <div class="col">
                Jul
            </div>
            <div class="col">
                Ago
            </div>
            <div class="col">
                Set
            </div>
            <div class="col">
                Out
            </div>
            <div class="col">
                Nov
            </div>
            <div class="col">
                Dez
            </div>
        </div>
        <div class="row" id="squares">
            <div id="sqr01" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr02" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr03" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr04" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr05" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr06" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr07" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr08" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr09" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr10" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr11" class="col">
                <div class="square"></div>
            </div>
            <div id="sqr12" class="col">
                <div class="square"></div>
            </div>
        </div>
    </div>
</div>
<br />
<br />
<div class="row">
    <div class="col-sm-7 card">
        <br />
        <dl class="row">
            <dt class="col-sm-2">
                RG
            </dt>
            <dd class="col-sm-3">
                @this.FormataDocumento(Model.RG)
            </dd>
            <dt class="col-sm-3">
                Data Nasc.
            </dt>
            <dd class="col-sm-4">
                @Html.DisplayFor(model => model.DataNascimento)
            </dd>
            <dt class="col-sm-2">
                Telefone
            </dt>
            <dd class="col-sm-3">
                @this.FormataTelefone(Model.Telefone1)
            </dd>
            <dt class="col-sm-3">
                Casas
            </dt>
            <dd class="col-sm-4">
                @Html.DisplayFor(model => model.QuantidadeCasas)
            </dd>
            <dt class="col-sm-2">
                Telefone
            </dt>
            <dd class="col-sm-3">
                @this.FormataTelefone(Model.Telefone2)
            </dd>
            <dt class="col-sm-3">
                Data Cadastro
            </dt>
            <dd class="col-sm-4">
                @Html.DisplayFor(model => model.CriadoEm)
            </dd>
        </dl>
    </div>
    <div class="col-sm-5 card">
        <br />
        <dl class="row">
            <dt class="col-sm-3">
                Endereço
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.Logradouro) @Html.DisplayFor(model => model.Numero) - (@Html.DisplayFor(model => model.Complemento))
            </dd>
            <dt class="col-sm-3">
                Bairro
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.Bairro)
            </dd>
            <dt class="col-sm-3">
                CEP
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.CEP)
            </dd>

        </dl>

    </div>
    </div>

<br/>

<div class="row">
    
    <div class="col-sm-12 card">
        <br />
        <dl class="row">
            <dt class="col-sm-2">
                Observação
            </dt>
            <dd class="col-sm-9">
                @Html.DisplayFor(model => model.Observacao)
            </dd>
        </dl>
    </div>
</div>
    <br/>
    <div>
        <a class="btn btn-warning" asp-action="Index" asp-route-id="@Model.Id">Voltar</a>
        <a class="btn btn-info" asp-action="Edit" asp-route-id="@Model.Id">Editar</a>
        @*<a asp-action="Edit" asp-route-id="@Model.Id">Editar</a> |
            <a asp-action="Index">Voltar</a>*@
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
    <script>
        $(document).ready(function () {
            $.ajax({
                dataType: "json",
                type: "GET",
                url: "/Mensalidade/MensalidadesPorPessoaAnoCorrente",
                data: { id: @Model.Id },
                success: function (result) {
                    document.querySelector('#squares').innerHTML = '';
                    for (var i = 1; i <= 12; i++) {
                        let mes = ("0" + i).slice(-2);
                        var mensalidade = result.find(obj => obj.mesVencimento === mes);
                        let isPago;

                        if (mensalidade != undefined && mensalidade.pago == true) {
                            isPago = 'square-pay';
                        }
                        else if (mensalidade != undefined && mensalidade.pago == false) {
                            isPago = 'square-not-pay';
                        }
                        else {
                            isPago = 'square';
                        }

                        document.querySelector('#squares').innerHTML += `<div class="col"><div class="${isPago}"></div></div>`;
                    };



                },
            });
        });
    </script>
    <style>
        .div-month .col {
            padding-right: 0px;
            padding-left: 0px;
        }

        .square {
            width: 24px;
            height: 24px;
            background-color: #555;
            border-radius: 3px;
        }

        .square-not-pay {
            width: 24px;
            height: 24px;
            background-color: red;
            border-radius: 3px;
        }

        .square-pay {
            width: 24px;
            height: 24px;
            background-color: lightgreen;
            border-radius: 3px;
        }
    </style>
